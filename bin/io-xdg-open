#!/bin/sh -e
# pick a file to open with xdg-open with iomenu with caching

LC_COLLATE=C

mkdir -p "$HOME/.cache"

test "$1" = -c || ! test -f "$HOME/.cache/find" &&
	find "$HOME" '(' -name .git -o -name CVS ')' -prune -o \
		-type d -exec printf '%s/\n' '{}' + -o \
		-type f -exec printf '%s\n' '{}' + |
		sort -o $HOME/.cache/find

exec xdg-open "$(iomenu <$HOME/.cache/find)"
